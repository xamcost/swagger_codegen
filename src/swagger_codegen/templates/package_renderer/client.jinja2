from dataclasses import dataclass
from {{ package_api_lib_module_name }}.client import ApiClient
from {{ package_api_lib_module_name }}.configuration import Configuration
from {{ package_api_lib_module_name }}.adapter.base import HttpClientAdapter
from {{ package_api_lib_module_name }}.response_deserializer import (
    DefaultResponseDeserializer,
    ResponseDeserializer,
)

{% for api in apis %}
from .apis.{{ api.name }}.api import {{ api.type_name }}
{% endfor %}


@dataclass
class AutogeneratedApiClient:
    configuration: Configuration
    client: ApiClient
    deserializer: ResponseDeserializer
    {%- for api in apis %}
    {{ api.name }}: {{ api.type_name }}
    {%- endfor %}


def new_client(
    adapter: HttpClientAdapter,
    configuration: Configuration,
    deserializer: ResponseDeserializer = DefaultResponseDeserializer(),
) -> AutogeneratedApiClient:
    client = ApiClient(configuration=configuration, adapter=adapter, deserializer=deserializer)
    return AutogeneratedApiClient(
        configuration,
        client=client,
        deserializer=deserializer,
        {% for api in apis %}
        {{ api.name }}={{ api.type_name }}(client, configuration, deserializer=deserializer){% if not loop.last %},{% endif %}
        {% endfor %}
    )
